(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6470b416"],{a434:function(e,t,s){"use strict";var a=s("23e7"),c=s("23cb"),r=s("a691"),n=s("50c4"),o=s("7b0b"),i=s("65f0"),l=s("8418"),u=s("1dde"),d=s("ae40"),p=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,m=Math.min,y=9007199254740991,v="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!p||!h},{splice:function(e,t){var s,a,u,d,p,h,g=o(this),b=n(g.length),S=c(e,b),_=arguments.length;if(0===_?s=a=0:1===_?(s=0,a=b-S):(s=_-2,a=m(f(r(t),0),b-S)),b+s-a>y)throw TypeError(v);for(u=i(g,a),d=0;d<a;d++)p=S+d,p in g&&l(u,d,g[p]);if(u.length=a,s<a){for(d=S;d<b-a;d++)p=d+a,h=d+s,p in g?g[h]=g[p]:delete g[h];for(d=b;d>b-a+s;d--)delete g[d-1]}else if(s>a)for(d=b-a;d>S;d--)p=d+a-1,h=d+s-1,p in g?g[h]=g[p]:delete g[h];for(d=0;d<s;d++)g[d+S]=arguments[d+2];return g.length=b-a+s,u}})},ecbd:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"col-sm"},[s("h3",{staticClass:"row text-info"},[e._v(" "+e._s(e._f("removeDash")(""+e.characterId))+" ")]),s("h4",{staticClass:"row text-light"},[e._v(" "+e._s("Visible "+e.issues.length+" issues of "+e.totalIssues+" total:")+" ")]),s("form",{staticClass:"row"},[s("div",{staticClass:"col-sm"},[e.user?s("div",{staticClass:"row form-group"},[s("label",{staticClass:"col-sm-1 pl-sm-0",attrs:{for:"read-dr"}},[e._v(" Status: ")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedReadStatus,expression:"selectedReadStatus"}],staticClass:"col-sm-1",attrs:{id:"read-dr"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedReadStatus=t.target.multiple?s:s[0]}}},e._l(e.readStatuses,(function(t){return s("option",{key:t},[e._v(" "+e._s(t)+" ")])})),0)]):s("div",[s("p",{staticStyle:{color:"orange"}},[e._v("Please log in to mark issues as read")])]),s("div",{staticClass:"row form-group"},[s("label",{staticClass:"col-sm-1 pl-sm-0"},[e._v("Focus types:")]),s("div",{staticClass:"custom-control custom-checkbox col-sm-auto"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.showEmptyFocusTypes,expression:"showEmptyFocusTypes"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"hide-focus-type"},domProps:{checked:Array.isArray(e.showEmptyFocusTypes)?e._i(e.showEmptyFocusTypes,null)>-1:e.showEmptyFocusTypes},on:{change:function(t){var s=e.showEmptyFocusTypes,a=t.target,c=!!a.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);a.checked?n<0&&(e.showEmptyFocusTypes=s.concat([r])):n>-1&&(e.showEmptyFocusTypes=s.slice(0,n).concat(s.slice(n+1)))}else e.showEmptyFocusTypes=c}}}),s("label",{staticClass:"custom-control-label",attrs:{for:"hide-focus-type"}},[e._v(" Empty ")])]),e._l(e.focusTypes,(function(t,a){return s("div",{key:"_"+t+a,staticClass:"custom-control custom-checkbox col-sm-auto"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedFocusTypes,expression:"selectedFocusTypes"}],key:a,staticClass:"custom-control-input",attrs:{id:t+a,type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selectedFocusTypes)?e._i(e.selectedFocusTypes,t)>-1:e.selectedFocusTypes},on:{change:function(s){var a=e.selectedFocusTypes,c=s.target,r=!!c.checked;if(Array.isArray(a)){var n=t,o=e._i(a,n);c.checked?o<0&&(e.selectedFocusTypes=a.concat([n])):o>-1&&(e.selectedFocusTypes=a.slice(0,o).concat(a.slice(o+1)))}else e.selectedFocusTypes=r}}}),s("label",{key:t,staticClass:"custom-control-label",attrs:{for:t+a}},[e._v(" "+e._s(" "+t+" ")+" ")])])}))],2),s("div",{staticClass:"row form-group"},[s("label",{staticClass:"col-sm-1 pl-sm-0"},[e._v("Appearances: ")]),s("div",{staticClass:"custom-control custom-checkbox col-sm-auto"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.showEmptyAppearanceTypes,expression:"showEmptyAppearanceTypes"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"hide-type"},domProps:{checked:Array.isArray(e.showEmptyAppearanceTypes)?e._i(e.showEmptyAppearanceTypes,null)>-1:e.showEmptyAppearanceTypes},on:{change:function(t){var s=e.showEmptyAppearanceTypes,a=t.target,c=!!a.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);a.checked?n<0&&(e.showEmptyAppearanceTypes=s.concat([r])):n>-1&&(e.showEmptyAppearanceTypes=s.slice(0,n).concat(s.slice(n+1)))}else e.showEmptyAppearanceTypes=c}}}),s("label",{staticClass:"custom-control-label",attrs:{for:"hide-type"}},[e._v("Empty")])]),e._l(e.appearanceTypes,(function(t,a){return s("div",{key:" "+a,staticClass:"custom-control custom-checkbox col-sm-auto"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedAppearances,expression:"selectedAppearances"}],key:a,staticClass:"custom-control-input",attrs:{type:"checkbox",id:t+a},domProps:{value:t,checked:Array.isArray(e.selectedAppearances)?e._i(e.selectedAppearances,t)>-1:e.selectedAppearances},on:{change:function(s){var a=e.selectedAppearances,c=s.target,r=!!c.checked;if(Array.isArray(a)){var n=t,o=e._i(a,n);c.checked?o<0&&(e.selectedAppearances=a.concat([n])):o>-1&&(e.selectedAppearances=a.slice(0,o).concat(a.slice(o+1)))}else e.selectedAppearances=r}}}),s("label",{key:t,staticClass:"custom-control-label",attrs:{for:t+a}},[e._v(" "+e._s(" "+t+" ")+" ")])])}))],2)])])]),s("section",{staticClass:"row"},[s("table",{staticClass:"table table-bordered table-striped table-sm"},[s("thead",{staticClass:"text-sm-center"},[s("tr",[e.user?s("th",[e._v("Read:")]):e._e(),s("th",[e._v("Issue name:")]),s("th",[e._v("Publication date:")]),s("th",[e._v("Volume:")]),s("th",[e._v("Issue no:")]),s("th",[e._v("Stories:")])])]),s("tbody",e._l(e.issues,(function(t,a){return s("tr",{key:a},[[e.user?s("td",["wait"===t.status?s("IconLoading"):s("div",{staticClass:"btn-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"issue.selected"}],staticClass:"form-check-inline mt-sm-2 ml-sm-1",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.selected)?e._i(t.selected,null)>-1:t.selected},on:{change:function(s){var a=t.selected,c=s.target,r=!!c.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);c.checked?o<0&&e.$set(t,"selected",a.concat([n])):o>-1&&e.$set(t,"selected",a.slice(0,o).concat(a.slice(o+1)))}else e.$set(t,"selected",r)}}}),"read"===t.status||"character"===t.status?s("button",{staticClass:"btn btn-danger",on:{click:function(s){return e.changeStatus([t.id],"clear")}}},[e._v(" Unread ")]):[s("button",{staticClass:"btn btn-primary",on:{click:function(s){return e.changeStatus([t.id],"read")}}},[e._v(" Read ")]),s("div",{staticClass:"btn-group mr-sm-1"},[s("button",{staticClass:"btn btn-primary dropdown-toggle",attrs:{"data-toggle":"dropdown"}}),s("div",{staticClass:"dropdown-menu"},[s("button",{staticClass:"dropdown-item",on:{click:function(s){return e.changeStatus([t.id],"character")}}},[e._v(" Mark read for this character ")]),s("button",{staticClass:"dropdown-item",on:{click:function(s){return e.changeFavouriteState(a,t.id,!t.isFavourite)}}},[e._v(" "+e._s(t.isFavourite?"Unfavourite":"Favourite")+" ")]),s("button",{staticClass:"dropdown-item",on:{click:function(s){return e.addIssueToIgnored(a,t.id)}}},[e._v(" Ignore ")])])])]],2)],1):e._e(),s("td",[t.isFavourite?s("img",{staticStyle:{width:"15px"},attrs:{src:"/img/FavIcon.png"}}):e._e(),s("a",{staticClass:"text-info",attrs:{type:"button"},on:{click:function(s){return e.showIssueDetails(t.id)}}},[e._v(" "+e._s(t.name)+" ")])]),s("td",[e._v(e._s(e._f("timestampToDate")(t.publishDateTimestamp)))]),s("td",[e._v(e._s(t.volume))]),s("td",[e._v(e._s(t.issueNo))]),s("td",[s("table",{staticClass:"table"},[e._m(0,!0),s("tbody",e._l(t.appearances,(function(t,a){return s("tr",{key:a,staticStyle:{"background-color":"inherit"}},[s("td",[e._v(e._s(t.subtitle))]),s("td",[e._v(e._s(t.focusType))]),s("td",[e._v(e._s(t.appearanceTypes))])])})),0)])])]],2)})),0)])]),s("div",{staticClass:"footer"},[s("div",{staticClass:"btn-group-sm card-footer"},[e.allVisibleIssuesShouldBeSelected?s("button",{staticClass:"btn btn-dark btn-sm",on:{click:function(t){e.allVisibleIssuesShouldBeSelected=!1}}},[e._v(" Unselect all visible issues ")]):s("button",{staticClass:"btn btn-dark btn-sm",on:{click:function(t){e.allVisibleIssuesShouldBeSelected=!0}}},[e._v(" Select all visible issues ")]),s("button",{staticClass:"btn btn-dark btn-sm",on:{click:function(t){return e.changeStateOfSelectedIssues("read")}}},[e._v(" Read selected issues ")]),s("button",{staticClass:"btn btn-dark btn-sm",on:{click:function(t){return e.changeStateOfSelectedIssues("character")}}},[e._v(" Read selected issues for this character only ")]),s("button",{staticClass:"btn btn-dark btn-sm",on:{click:function(t){return e.changeStateOfSelectedIssues("clear")}}},[e._v(" Unread selected issues ")])])])])},c=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",{staticClass:"text-sm-center",staticStyle:{"background-color":"inherit"}},[s("th",[e._v("Subtitle")]),s("th",[e._v("Focus type")]),s("th",[e._v("Appearance type")])])])}],r=(s("4de4"),s("7db0"),s("4160"),s("caad"),s("c975"),s("a15b"),s("d81d"),s("45fc"),s("a434"),s("4fad"),s("ac1f"),s("2532"),s("5319"),s("159b"),s("96cf"),s("1da1")),n=s("3835"),o=s("5530"),i=s("c5329"),l=s("0a65"),u=s("bc3a"),d=s.n(u),p=s("2f62"),h={data:function(){return{characterId:"",universe:"",readStatuses:["All","Read","Not read"],focusTypes:[],selectedFocusTypes:[],selectedReadStatus:"Not read",characterData:void 0,appearanceTypes:[],selectedAppearances:[],totalIssues:0,visibleIssues:0,showEmptyAppearanceTypes:!0,showEmptyFocusTypes:!0,allVisibleIssuesShouldBeSelected:!1}},watch:{selectedAppearances:function(e,t){if(this.allVisibleIssuesShouldBeSelected=!1,!(e.length-t.length>1||e.length===t.length))if(e.length>t.length){var s=e.filter((function(e){return-1===t.indexOf(e)}));this.editStoredSettings(!1,!1,s[0])}else{var a=t.filter((function(t){return-1===e.indexOf(t)}));this.editStoredSettings(!0,!1,a[0])}},selectedFocusTypes:function(e,t){if(this.allVisibleIssuesShouldBeSelected=!1,!(e.length-t.length>1||e.length===t.length))if(e.length>t.length){var s=e.filter((function(e){return-1===t.indexOf(e)}));this.editStoredSettings(!1,!0,s[0])}else{var a=t.filter((function(t){return-1===e.indexOf(t)}));this.editStoredSettings(!0,!0,a[0])}},showEmptyAppearanceTypes:function(e){this.allVisibleIssuesShouldBeSelected=!1,this.editStoredSettings(!e,!1,"Empty")},showEmptyFocusTypes:function(e){this.allVisibleIssuesShouldBeSelected=!1,this.editStoredSettings(!e,!0,"Empty")},isUserLoadInProgress:function(e){e||this.loadIssuePage()}},computed:Object(o["a"])({},Object(p["c"])("user",["user","isUserLoadInProgress"]),{issues:function(){var e=this;if(!this.characterData)return{};var t=this.selectedReadStatus,s=this.selectedFocusTypes,a=this.selectedAppearances;return this.characterData.issues.filter((function(c){return c.selected=!1,!c.isIgnored&&(!(!("Read"!==t||c.status&&"clear"!==c.status)||"Not read"===t&&c.status&&"wait"!==c.status&&"clear"!==c.status)&&(!(s.length!==e.focusTypes.length&&c.appearances.length&&!c.appearances.some((function(e){return!e.focusType||s.includes(e.focusType)}))||!(e.showEmptyFocusTypes||c.appearances&&c.appearances.some((function(e){return e.focusType}))))&&(!!(c.appearances.some((function(t){return t.appearanceTypes.some((function(e){return a.indexOf(e)>-1}))||e.showEmptyAppearanceTypes&&0===t.appearanceTypes.length}))||e.showEmptyAppearanceTypes&&!c.appearances.length)&&(c.selected=e.allVisibleIssuesShouldBeSelected,!0))))}))}}),methods:Object(o["a"])({},Object(p["b"])("issue",["changeIgnoreStateOfIssue","changeFavouriteStateOfIssue","changeStatusOfIssues"]),{changeStateOfSelectedIssues:function(e){var t=this.issues.filter((function(e){return e.selected})).map((function(e){return e.id}));this.changeStatus(t,e)},changeStatus:function(e,t){var s=this,a=this.issues;a.filter((function(t){return e.includes(t.id)})).forEach((function(e){return e.status="wait"})),this.changeStatusOfIssues({issuesIds:e,status:t,characterId:this.characterId}).then((function(e){for(var t=function(){var e=Object(n["a"])(c[a],2),t=e[0],r=e[1];s.issues.find((function(e){return e.id===t})).status=r.status},a=0,c=Object.entries(e.data);a<c.length;a++)t();s.allVisibleIssuesShouldBeSelected=!1})).catch((function(e){console.error(e),s.$fire({text:"You are not authorized to do such action",type:"error"}),s.loadIssuePage()}))},loadIssuePage:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.characterId=e.$route.query.characterId,e.selectedFocusTypes=e.focusTypes,e.showEmptyAppearanceTypes=!0,e.showEmptyFocusTypes=!0,d.a.get("getAllIssuesForCharacter",{params:{characterId:e.characterId},mcamAuthenticated:!0}).then((function(t){e.characterData=t.data.characterData,e.appearanceTypes=t.data.setOfAppearanceTypes;var s=JSON.parse(localStorage.getItem("disabledAppearanceTypes"))||[];e.showEmptyAppearanceTypes=-1===s.indexOf("Empty"),e.selectedAppearances=t.data.setOfAppearanceTypes.filter((function(e){return-1===s.indexOf(e)})),e.focusTypes=t.data.setOfFocusTypes;var a=JSON.parse(localStorage.getItem("disabledFocusTypes"))||[];e.showEmptyFocusTypes=-1===a.indexOf("Empty"),e.selectedFocusTypes=t.data.setOfFocusTypes.filter((function(e){return-1===a.indexOf(e)})),e.totalIssues=t.data.characterData.issues.length})).catch((function(e){console.error(e)})),e.addOccurrenceToLastVisitedCharacter(e.characterId);case 6:case"end":return t.stop()}}),t)})))()},addOccurrenceToLastVisitedCharacter:function(e){var t=JSON.parse(localStorage.getItem("lastCharacters"));t||(t=[]);var s=t.find((function(t){return t.id===e}));s||(s={id:e,occurrence:0},t.push(s)),s.occurrence++,s.timestamp=(new Date).getTime();var a=30;t.length>a&&(t.sort((function(e,t){return e.timestamp>t.timestamp?-1:1})),t.splice(a,t.length-a)),t.sort((function(e,t){return e.occurrence>t.occurrence?-1:e.occurrence<t.occurrence?1:e.timestamp>t.timestamp?-1:1})),localStorage.setItem("lastCharacters",JSON.stringify(t))},showIssueDetails:function(e){this.$modal.show(l["a"],{issueId:e,markIssueAsFn:this.markIssueAs},{height:"auto",scrollable:!0,width:1e3})},editStoredSettings:function(e,t,s){t?this.addToLocalStorage("disabledFocusTypes",e,s):this.addToLocalStorage("disabledAppearanceTypes",e,s)},addToLocalStorage:function(e,t,s){var a=JSON.parse(localStorage.getItem(e))||[],c=a.indexOf(s);t&&-1===c?a.push(s):!t&&c>-1&&a.splice(c,1),localStorage.setItem(e,JSON.stringify(a))},changeFavouriteState:function(e,t,s){var a=this;this.changeFavouriteStateOfIssue({issueId:t,state:s}).then((function(){a.issues[e].isFavourite=s})).catch((function(e){console.error(e)}))},addIssueToIgnored:function(e,t){var s=this;this.changeIgnoreStateOfIssue({issueId:t,state:!0}).then((function(){s.totalIssues-=1,s.issues[e].isIgnored=!0})).catch((function(e){console.error(e)}))},markIssueAs:function(e,t,s){var a=this.characterData.issues.find((function(t){return t.id===e}));"favourite"===t?a.isFavourite=s:"ignore"===t?(this.totalIssues+=s?-1:1,a.isIgnored=s):a.status=t}}),filters:{timestampToDate:function(e){var t=new Date(e),s=t.getFullYear(),a=""+(t.getMonth()+1);return a.length<2&&(a="0"+a),[s,a].join("-")},removeDash:function(e){return e.replace(/_/g," ")}},beforeRouteUpdate:function(e,t,s){s(),this.loadIssuePage()},mounted:function(){this.loadIssuePage()},components:{IconLoading:i["a"]}},f=h,m=s("2877"),y=Object(m["a"])(f,a,c,!1,null,null,null);t["default"]=y.exports}}]);
//# sourceMappingURL=chunk-6470b416.98105461.js.map